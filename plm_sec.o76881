[2023-07-17 15:17:14,397] [INFO] [real_accelerator.py:110:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-07-17 15:17:15,999] [WARNING] [runner.py:196:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2023-07-17 15:17:16,023] [INFO] [runner.py:555:main] cmd = /home/h_ghazik/python_venv/bin/python3 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMl19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None plm_secondary_integration.py
[2023-07-17 15:17:17,349] [INFO] [real_accelerator.py:110:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-07-17 15:17:18,550] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2]}
[2023-07-17 15:17:18,551] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=3, node_rank=0
[2023-07-17 15:17:18,551] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2]})
[2023-07-17 15:17:18,551] [INFO] [launch.py:163:main] dist_world_size=3
[2023-07-17 15:17:18,551] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2
[2023-07-17 15:17:20,149] [INFO] [real_accelerator.py:110:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-07-17 15:17:20,181] [INFO] [real_accelerator.py:110:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-07-17 15:17:20,343] [INFO] [real_accelerator.py:110:get_accelerator] Setting ds_accelerator to cuda (auto detect)
07/17/2023 15:17:23 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-97958ba7915241de/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 294.59it/s]
07/17/2023 15:17:23 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-97958ba7915241de/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 309.06it/s]
07/17/2023 15:17:23 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-97958ba7915241de/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 289.50it/s]
07/17/2023 15:17:23 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-12841895c97fd58d/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 410.16it/s]
07/17/2023 15:17:23 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-12841895c97fd58d/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 452.26it/s]
07/17/2023 15:17:24 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-12841895c97fd58d/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 405.95it/s]
07/17/2023 15:17:24 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-a89e1921232f44fe/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 316.48it/s]
07/17/2023 15:17:24 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-a89e1921232f44fe/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 368.79it/s]
07/17/2023 15:17:24 - WARNING - datasets.builder - Found cached dataset csv (/home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-a89e1921232f44fe/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 635.98it/s]
Running tokenizer on dataset:   0%|          | 0/10792 [00:00<?, ? examples/s]Running tokenizer on dataset:   0%|          | 0/10792 [00:00<?, ? examples/s]07/17/2023 15:17:24 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-97958ba7915241de/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-9aa555e4178ad23b.arrow
Running tokenizer on dataset:   0%|          | 0/20 [00:00<?, ? examples/s]                                                                           07/17/2023 15:17:24 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/h_ghazik/.cache/huggingface/datasets/proteinea___csv/proteinea--secondary_structure_prediction-a89e1921232f44fe/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-dd1ff88dd2e59749.arrow
Running tokenizer on dataset:   9%|▉         | 1000/10792 [00:00<00:02, 3452.44 examples/s]Running tokenizer on dataset:   9%|▉         | 1000/10792 [00:00<00:02, 4005.44 examples/s]Running tokenizer on dataset:  19%|█▊        | 2000/10792 [00:00<00:02, 3481.76 examples/s]Running tokenizer on dataset:  19%|█▊        | 2000/10792 [00:00<00:03, 2700.59 examples/s]Running tokenizer on dataset:  28%|██▊       | 3000/10792 [00:00<00:01, 3903.97 examples/s]Running tokenizer on dataset:  28%|██▊       | 3000/10792 [00:00<00:02, 3310.55 examples/s]Running tokenizer on dataset:  37%|███▋      | 4000/10792 [00:00<00:01, 4218.63 examples/s]Running tokenizer on dataset:  37%|███▋      | 4000/10792 [00:01<00:01, 3712.42 examples/s]Running tokenizer on dataset:  46%|████▋     | 5000/10792 [00:01<00:01, 4457.35 examples/s]Running tokenizer on dataset:  46%|████▋     | 5000/10792 [00:01<00:01, 3893.95 examples/s]Running tokenizer on dataset:  56%|█████▌    | 6000/10792 [00:01<00:01, 4700.66 examples/s]Running tokenizer on dataset:  56%|█████▌    | 6000/10792 [00:01<00:01, 3991.99 examples/s]Running tokenizer on dataset:  65%|██████▍   | 7000/10792 [00:01<00:00, 4692.37 examples/s]Running tokenizer on dataset:  65%|██████▍   | 7000/10792 [00:01<00:00, 4045.95 examples/s]Running tokenizer on dataset:  74%|███████▍  | 8000/10792 [00:01<00:00, 4592.26 examples/s]Running tokenizer on dataset:  83%|████████▎ | 9000/10792 [00:02<00:00, 4627.18 examples/s]Running tokenizer on dataset:  74%|███████▍  | 8000/10792 [00:02<00:00, 4219.81 examples/s]Running tokenizer on dataset:  83%|████████▎ | 9000/10792 [00:02<00:00, 4332.09 examples/s]Running tokenizer on dataset:  93%|█████████▎| 10000/10792 [00:02<00:00, 4600.51 examples/s]Running tokenizer on dataset: 100%|██████████| 10792/10792 [00:02<00:00, 4417.12 examples/s]                                                                                            Running tokenizer on dataset:  93%|█████████▎| 10000/10792 [00:02<00:00, 4418.07 examples/s]Running tokenizer on dataset:   0%|          | 0/20 [00:00<?, ? examples/s]                                                                           Running tokenizer on dataset:   0%|          | 0/18 [00:00<?, ? examples/s]                                                                           Running tokenizer on dataset: 100%|██████████| 10792/10792 [00:02<00:00, 4625.73 examples/s]                                                                                            Running tokenizer on dataset:   0%|          | 0/20 [00:00<?, ? examples/s]                                                                           Running tokenizer on dataset:   0%|          | 0/18 [00:00<?, ? examples/s]                                                                           [2023-07-17 15:17:52,588] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-07-17 15:17:52,592] [INFO] [comm.py:594:init_distributed] cdb=None
[2023-07-17 15:17:52,592] [INFO] [comm.py:625:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2023-07-17 15:17:55,627] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-07-17 15:17:55,627] [INFO] [comm.py:594:init_distributed] cdb=None
[2023-07-17 15:17:55,754] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-07-17 15:17:55,754] [INFO] [comm.py:594:init_distributed] cdb=None
Rank: 2 partition count [3] and sizes[(626235052, False)] 
Rank: 1 partition count [3] and sizes[(626235052, False)] 
Rank: 0 partition count [3] and sizes[(626235052, False)] 
  0%|          | 0/35980 [00:00<?, ?it/s]  0%|          | 1/35980 [00:01<14:14:18,  1.42s/it]  0%|          | 2/35980 [00:02<9:55:57,  1.01it/s]   0%|          | 3/35980 [00:02<8:31:23,  1.17it/s]  0%|          | 4/35980 [00:03<7:55:17,  1.26it/s]  0%|          | 5/35980 [00:04<7:35:55,  1.32it/s]  0%|          | 6/35980 [00:04<7:21:33,  1.36it/s]  0%|          | 7/35980 [00:05<7:12:46,  1.39it/s]  0%|          | 8/35980 [00:06<7:06:34,  1.41it/s]  0%|          | 9/35980 [00:06<7:03:13,  1.42it/s]  0%|          | 10/35980 [00:07<7:01:44,  1.42it/s]  0%|          | 11/35980 [00:08<7:04:48,  1.41it/s]  0%|          | 12/35980 [00:09<7:02:03,  1.42it/s]  0%|          | 13/35980 [00:09<7:02:28,  1.42it/s]  0%|          | 14/35980 [00:10<6:57:44,  1.43it/s]  0%|          | 15/35980 [00:11<6:57:55,  1.43it/s]  0%|          | 16/35980 [00:11<6:58:10,  1.43it/s]  0%|          | 17/35980 [00:12<6:58:26,  1.43it/s]Traceback (most recent call last):
Traceback (most recent call last):
  File "plm_secondary_integration.py", line 175, in <module>
  File "plm_secondary_integration.py", line 175, in <module>
Traceback (most recent call last):
  File "plm_secondary_integration.py", line 175, in <module>
        trainer.train()    
trainer.train()
trainer.train()  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 1649, in train
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 1649, in train

  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 1649, in train
    ignore_keys_for_eval=ignore_keys_for_eval,
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 1938, in _inner_training_loop
    ignore_keys_for_eval=ignore_keys_for_eval,
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 1938, in _inner_training_loop
    ignore_keys_for_eval=ignore_keys_for_eval,
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 1938, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 2770, in training_step
    tr_loss_step = self.training_step(model, inputs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 2770, in training_step
    tr_loss_step = self.training_step(model, inputs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/transformers/trainer.py", line 2770, in training_step
    self.accelerator.backward(loss)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/accelerate/accelerator.py", line 1815, in backward
    self.accelerator.backward(loss)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/accelerate/accelerator.py", line 1815, in backward
    self.accelerator.backward(loss)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/accelerate/accelerator.py", line 1815, in backward
    self.deepspeed_engine_wrapped.backward(loss, **kwargs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/accelerate/utils/deepspeed.py", line 176, in backward
    self.deepspeed_engine_wrapped.backward(loss, **kwargs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/accelerate/utils/deepspeed.py", line 176, in backward
    self.deepspeed_engine_wrapped.backward(loss, **kwargs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/accelerate/utils/deepspeed.py", line 176, in backward
    self.engine.step()
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/engine.py", line 2053, in step
    self.engine.step()
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/engine.py", line 2053, in step
    self.engine.step()
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/engine.py", line 2053, in step
    self._take_model_step(lr_kwargs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/engine.py", line 1960, in _take_model_step
    self._take_model_step(lr_kwargs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/engine.py", line 1960, in _take_model_step
    self._take_model_step(lr_kwargs)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/engine.py", line 1960, in _take_model_step
    self.optimizer.step()
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1657, in step
    self.optimizer.step()
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1657, in step
    self.optimizer.step()
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1657, in step
    self._update_scale(self.overflow)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1906, in _update_scale
    self._update_scale(self.overflow)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1906, in _update_scale
    self._update_scale(self.overflow)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1906, in _update_scale
    self.loss_scaler.update_scale(has_overflow)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 176, in update_scale
    self.loss_scaler.update_scale(has_overflow)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 176, in update_scale
    self.loss_scaler.update_scale(has_overflow)
  File "/home/h_ghazik/python_venv/lib/python3.7/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 176, in update_scale
    "Current loss scale already at minimum - cannot decrease scale anymore. Exiting run.")
Exception: Current loss scale already at minimum - cannot decrease scale anymore. Exiting run.
    "Current loss scale already at minimum - cannot decrease scale anymore. Exiting run.")
Exception: Current loss scale already at minimum - cannot decrease scale anymore. Exiting run.
    "Current loss scale already at minimum - cannot decrease scale anymore. Exiting run.")
Exception: Current loss scale already at minimum - cannot decrease scale anymore. Exiting run.
  0%|          | 17/35980 [00:13<7:57:04,  1.26it/s]
[2023-07-17 15:18:31,685] [INFO] [launch.py:315:sigkill_handler] Killing subprocess 298539
[2023-07-17 15:18:31,952] [INFO] [launch.py:315:sigkill_handler] Killing subprocess 298540
[2023-07-17 15:18:31,991] [INFO] [launch.py:315:sigkill_handler] Killing subprocess 298541
[2023-07-17 15:18:31,991] [ERROR] [launch.py:321:sigkill_handler] ['/home/h_ghazik/python_venv/bin/python3', '-u', 'plm_secondary_integration.py', '--local_rank=2'] exits with return code = 1
